#!/bin/bash

# Function to process a single simulation directory
process_sim_dir() {
  subdir="$1"
  echo $subdir
  # Change directory to scripts location
  cd /pbs/home/j/jpeterei/grand/scripts

  echo "efield2voltage no noise"
  # 2: produce voltage without noise
  echo python3 convert_efield2voltage.py $subdir
  python3 convert_efield2voltage.py $subdir \
                                  --seed=$RANDOM \
                                  --no_noise

  echo "ADC"
  # 3: produce ADC
  echo python3 convert_voltage2adc.py $subdir
  python3 convert_voltage2adc.py $subdir

  echo "DC2"
  # 4: produce DC2 efield
  echo python3 convert_efield2efield.py $subdir
  python3 convert_efield2efield.py $subdir\
                                 --target_duration_us=4.096 \
                                 --target_sampling_rate_mhz=500


}
subdirs=(
sim_Dunhuang_20170331_220000_RUN1_CD__0821
sim_Dunhuang_20170331_220000_RUN1_CD__0822
sim_Dunhuang_20170331_220000_RUN1_CD__0823
sim_Dunhuang_20170331_220000_RUN1_CD__0824
sim_Dunhuang_20170331_220000_RUN1_CD__0825
sim_Dunhuang_20170331_220000_RUN1_CD__0826
sim_Dunhuang_20170331_220000_RUN1_CD__0827
sim_Dunhuang_20170331_220000_RUN1_CD__0828
sim_Dunhuang_20170331_220000_RUN1_CD__0829
sim_Dunhuang_20170331_220000_RUN1_CD__0830
sim_Dunhuang_20170331_220000_RUN1_CD__0831
sim_Dunhuang_20170331_220000_RUN1_CD__0832
sim_Dunhuang_20170331_220000_RUN1_CD__0833
sim_Dunhuang_20170331_220000_RUN1_CD__0834
sim_Dunhuang_20170331_220000_RUN1_CD__0835
sim_Dunhuang_20170331_220000_RUN1_CD__0836
sim_Dunhuang_20170331_220000_RUN1_CD__0837
sim_Dunhuang_20170331_220000_RUN1_CD__0838
sim_Dunhuang_20170331_220000_RUN1_CD__0839
sim_Dunhuang_20170331_220000_RUN1_CD__0840
sim_Dunhuang_20170331_220000_RUN1_CD__0841
sim_Dunhuang_20170331_220000_RUN1_CD__0842
sim_Dunhuang_20170331_220000_RUN1_CD__0843
sim_Dunhuang_20170331_220000_RUN1_CD__0844
sim_Dunhuang_20170331_220000_RUN1_CD__0845
sim_Dunhuang_20170331_220000_RUN1_CD__0846
sim_Dunhuang_20170331_220000_RUN1_CD__0847
sim_Dunhuang_20170331_220000_RUN1_CD__0848
sim_Dunhuang_20170331_220000_RUN1_CD__0849
sim_Dunhuang_20170331_220000_RUN1_CD__0850
sim_Dunhuang_20170331_220000_RUN1_CD__0851
sim_Dunhuang_20170331_220000_RUN1_CD__0852
sim_Dunhuang_20170331_220000_RUN1_CD__0853
sim_Dunhuang_20170331_220000_RUN1_CD__0854
sim_Dunhuang_20170331_220000_RUN1_CD__0855
sim_Dunhuang_20170331_220000_RUN1_CD__0856
sim_Dunhuang_20170331_220000_RUN1_CD__0857
sim_Dunhuang_20170331_220000_RUN1_CD__0858
sim_Dunhuang_20170331_220000_RUN1_CD__0859
sim_Dunhuang_20170331_220000_RUN1_CD__0860
sim_Dunhuang_20170331_220000_RUN1_CD__0861
sim_Dunhuang_20170331_220000_RUN1_CD__0862
sim_Dunhuang_20170331_220000_RUN1_CD__0863
sim_Dunhuang_20170331_220000_RUN1_CD__0864
sim_Dunhuang_20170331_220000_RUN1_CD__0865
sim_Dunhuang_20170331_220000_RUN1_CD__0866
sim_Dunhuang_20170331_220000_RUN1_CD__0867
sim_Dunhuang_20170331_220000_RUN1_CD__0868
sim_Dunhuang_20170331_220000_RUN1_CD__0869
sim_Dunhuang_20170331_220000_RUN1_CD__0870
sim_Dunhuang_20170331_220000_RUN1_CD__0871
sim_Dunhuang_20170331_220000_RUN1_CD__0872
sim_Dunhuang_20170331_220000_RUN1_CD__0873
sim_Dunhuang_20170331_220000_RUN1_CD__0874
sim_Dunhuang_20170331_220000_RUN1_CD__0875
sim_Dunhuang_20170331_220000_RUN1_CD__0876
sim_Dunhuang_20170331_220000_RUN1_CD__0877
sim_Dunhuang_20170331_220000_RUN1_CD__0878
sim_Dunhuang_20170331_220000_RUN1_CD__0879
sim_Dunhuang_20170331_220000_RUN1_CD__0880
sim_Dunhuang_20170331_220000_RUN1_CD__0881
sim_Dunhuang_20170331_220000_RUN1_CD__0882
sim_Dunhuang_20170331_220000_RUN1_CD__0883
sim_Dunhuang_20170331_220000_RUN1_CD__0884
sim_Dunhuang_20170331_220000_RUN1_CD__0885
sim_Dunhuang_20170331_220000_RUN1_CD__0886
sim_Dunhuang_20170331_220000_RUN1_CD__0887
sim_Dunhuang_20170331_220000_RUN1_CD__0888
sim_Dunhuang_20170331_220000_RUN1_CD__0889
sim_Dunhuang_20170331_220000_RUN1_CD__0890
sim_Dunhuang_20170331_220000_RUN1_CD__0891
sim_Dunhuang_20170331_220000_RUN1_CD__0892
sim_Dunhuang_20170331_220000_RUN1_CD__0893
sim_Dunhuang_20170331_220000_RUN1_CD__0894
sim_Dunhuang_20170331_220000_RUN1_CD__0895
sim_Dunhuang_20170331_220000_RUN1_CD__0896
sim_Dunhuang_20170331_220000_RUN1_CD__0897
sim_Dunhuang_20170331_220000_RUN1_CD__0898
sim_Dunhuang_20170331_220000_RUN1_CD__0899
sim_Dunhuang_20170331_220000_RUN1_CD__0900
sim_Dunhuang_20170331_220000_RUN1_CD__0901
sim_Dunhuang_20170331_220000_RUN1_CD__0902
sim_Dunhuang_20170331_220000_RUN1_CD__0903
sim_Dunhuang_20170331_220000_RUN1_CD__0904
sim_Dunhuang_20170331_220000_RUN1_CD__0905
sim_Dunhuang_20170331_220000_RUN1_CD__0906
sim_Dunhuang_20170331_220000_RUN1_CD__0907
sim_Dunhuang_20170331_220000_RUN1_CD__0908
sim_Dunhuang_20170331_220000_RUN1_CD__0909
sim_Dunhuang_20170331_220000_RUN1_CD__0910
sim_Dunhuang_20170331_220000_RUN1_CD__0911
sim_Dunhuang_20170331_220000_RUN1_CD__0912
sim_Dunhuang_20170331_220000_RUN1_CD__0913
sim_Dunhuang_20170331_220000_RUN1_CD__0914
sim_Dunhuang_20170331_220000_RUN1_CD__0915
sim_Dunhuang_20170331_220000_RUN1_CD__0916
sim_Dunhuang_20170331_220000_RUN1_CD__0917
sim_Dunhuang_20170331_220000_RUN1_CD__0918
sim_Dunhuang_20170331_220000_RUN1_CD__0919
sim_Dunhuang_20170331_220000_RUN1_CD__0920
sim_Dunhuang_20170331_220000_RUN1_CD__0921
sim_Dunhuang_20170331_220000_RUN1_CD__0922
sim_Dunhuang_20170331_220000_RUN1_CD__0923
sim_Dunhuang_20170331_220000_RUN1_CD__0924
sim_Dunhuang_20170331_220000_RUN1_CD__0925
sim_Dunhuang_20170331_220000_RUN1_CD__0926
sim_Dunhuang_20170331_220000_RUN1_CD__0927
sim_Dunhuang_20170331_220000_RUN1_CD__0928
sim_Dunhuang_20170331_220000_RUN1_CD__0929
sim_Dunhuang_20170331_220000_RUN1_CD__0930
sim_Dunhuang_20170331_220000_RUN1_CD__0931
sim_Dunhuang_20170331_220000_RUN1_CD__0932
sim_Dunhuang_20170331_220000_RUN1_CD__0933
sim_Dunhuang_20170331_220000_RUN1_CD__0934
sim_Dunhuang_20170331_220000_RUN1_CD__0935
sim_Dunhuang_20170331_220000_RUN1_CD__0936
sim_Dunhuang_20170331_220000_RUN1_CD__0937
sim_Dunhuang_20170331_220000_RUN1_CD__0938
sim_Dunhuang_20170331_220000_RUN1_CD__0939
sim_Dunhuang_20170331_220000_RUN1_CD__0940
sim_Dunhuang_20170331_220000_RUN1_CD__0941
sim_Dunhuang_20170331_220000_RUN1_CD__0942
sim_Dunhuang_20170331_220000_RUN1_CD__0943
sim_Dunhuang_20170331_220000_RUN1_CD__0944
sim_Dunhuang_20170331_220000_RUN1_CD__0945
sim_Dunhuang_20170331_220000_RUN1_CD__0946
sim_Dunhuang_20170331_220000_RUN1_CD__0947
sim_Dunhuang_20170331_220000_RUN1_CD__0948
sim_Dunhuang_20170331_220000_RUN1_CD__0949
sim_Dunhuang_20170331_220000_RUN1_CD__0950
sim_Dunhuang_20170331_220000_RUN1_CD__0951
sim_Dunhuang_20170331_220000_RUN1_CD__0952
sim_Dunhuang_20170331_220000_RUN1_CD__0953
sim_Dunhuang_20170331_220000_RUN1_CD__0954
sim_Dunhuang_20170331_220000_RUN1_CD__0955
sim_Dunhuang_20170331_220000_RUN1_CD__0956
sim_Dunhuang_20170331_220000_RUN1_CD__0957
sim_Dunhuang_20170331_220000_RUN1_CD__0958
sim_Dunhuang_20170331_220000_RUN1_CD__0959
sim_Dunhuang_20170331_220000_RUN1_CD__0960
sim_Dunhuang_20170331_220000_RUN1_CD__0961
sim_Dunhuang_20170331_220000_RUN1_CD__0962
sim_Dunhuang_20170331_220000_RUN1_CD__0963
sim_Dunhuang_20170331_220000_RUN1_CD__0964
sim_Dunhuang_20170331_220000_RUN1_CD__0965
sim_Dunhuang_20170331_220000_RUN1_CD__0966
sim_Dunhuang_20170331_220000_RUN1_CD__0967
sim_Dunhuang_20170331_220000_RUN1_CD__0968
sim_Dunhuang_20170331_220000_RUN1_CD__0969
sim_Dunhuang_20170331_220000_RUN1_CD__0970
sim_Dunhuang_20170331_220000_RUN1_CD__0971
sim_Dunhuang_20170331_220000_RUN1_CD__0972
sim_Dunhuang_20170331_220000_RUN1_CD__0973
sim_Dunhuang_20170331_220000_RUN1_CD__0974
sim_Dunhuang_20170331_220000_RUN1_CD__0975
sim_Dunhuang_20170331_220000_RUN1_CD__0976
sim_Dunhuang_20170331_220000_RUN1_CD__0977
sim_Dunhuang_20170331_220000_RUN1_CD__0978
sim_Dunhuang_20170331_220000_RUN1_CD__0979
sim_Dunhuang_20170331_220000_RUN1_CD__0980
sim_Dunhuang_20170331_220000_RUN1_CD__0981
sim_Dunhuang_20170331_220000_RUN1_CD__0982
sim_Dunhuang_20170331_220000_RUN1_CD__0983
sim_Dunhuang_20170331_220000_RUN1_CD__0984
sim_Dunhuang_20170331_220000_RUN1_CD__0985
sim_Dunhuang_20170331_220000_RUN1_CD__0986
sim_Dunhuang_20170331_220000_RUN1_CD__0987
sim_Dunhuang_20170331_220000_RUN1_CD__0988
sim_Dunhuang_20170331_220000_RUN1_CD__0989
sim_Dunhuang_20170331_220000_RUN1_CD__0990
sim_Dunhuang_20170331_220000_RUN1_CD__0991
sim_Dunhuang_20170331_220000_RUN1_CD__0992
sim_Dunhuang_20170331_220000_RUN1_CD__0993
sim_Dunhuang_20170331_220000_RUN1_CD__0994
sim_Dunhuang_20170331_220000_RUN1_CD__0995
sim_Dunhuang_20170331_220000_RUN1_CD__0996
sim_Dunhuang_20170331_220000_RUN1_CD__0997
sim_Dunhuang_20170331_220000_RUN1_CD__0998
sim_Dunhuang_20170331_220000_RUN1_CD__0999
)

base_path="/sps/grand/jelena/GP300/root_nonoise"
for subdir in "${subdirs[@]}"; do
  process_sim_dir "$base_path/$subdir"
done

echo "Finished processing all simulations."
